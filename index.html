<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pyramid Counter</title>
<style>
body {
  margin:0; font-family:sans-serif; background: radial-gradient(circle at center, #1a1a1a, #121212); color:#fff;
  display:flex; justify-content:center; align-items:center; height:100vh; overflow:hidden;
}
.card {
  position:relative; width:360px; padding:24px; background:#1e1e1e; border-radius:24px;
  text-align:center; box-shadow:0 12px 24px rgba(0,0,0,0.6);
  transition: transform 0.3s ease;
}
.card:hover { transform: scale(1.02); }

#bigBtn {
  width:200px; height:200px; border-radius:50%; border:2px solid #fff;
  background: linear-gradient(145deg, #0b84ff, #3299ff); color:#fff;
  font-size:64px; cursor:pointer; margin-bottom:20px; box-shadow:0 8px 16px rgba(0,0,0,0.4);
  transition: all 0.2s ease;
}
#bigBtn:hover { transform: scale(1.05) translateY(-2px); box-shadow:0 12px 20px rgba(0,0,0,0.6); }
#bigBtn:active { transform: scale(0.98) translateY(1px); box-shadow:0 4px 8px rgba(0,0,0,0.4); }

#prog {
  width:150px; height:150px; position:absolute; top:36px; left:105px; transform:rotate(-90deg);
  filter: drop-shadow(0 0 8px rgba(0,255,0,0.7));
}
#stepText { margin-top:10px; font-size:16px; }

#maxInput, #customSecondsPerRep, #restPerRepSec, #modeSelect {
  margin:6px 0; width:100%; padding:8px; border-radius:10px; border:none; font-size:16px;
  background: #2a2a2a; color:#fff;
}

button { margin:6px; padding:10px 16px; border:none; border-radius:16px; font-size:16px; cursor:pointer; transition:all 0.2s ease; }
button:hover { transform: scale(1.05); box-shadow:0 6px 12px rgba(0,0,0,0.4); }

#autoBtn { background: linear-gradient(145deg, #0b84ff, #3299ff); color:#fff; }
#resetBtn { background:#555; color:#fff; }

#soundIcon, #settingsIcon, #helpIcon {
  position:absolute; width:36px; height:36px; border-radius:50%; border:1px solid rgba(255,255,255,0.12);
  display:flex; align-items:center; justify-content:center; font-size:20px; cursor:pointer; background:rgba(0,0,0,0.25);
  box-shadow:0 4px 8px rgba(0,0,0,0.4); transition:all 0.2s ease;
}
#soundIcon:hover, #settingsIcon:hover, #helpIcon:hover { transform: scale(1.1); background:rgba(0,0,0,0.35); }

#soundIcon { top:16px; left:16px; }
#settingsIcon { top:16px; left:64px; }
#helpIcon { top:16px; right:16px; }

#helpPopup, #settingsPopup {
  display:none; position:fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.95); color:#fff; padding:24px; box-sizing:border-box; overflow-y:auto; z-index:20; border-radius:0;
  backdrop-filter: blur(4px);
  animation: fadeIn 0.3s ease;
}

#closeHelp, #closeSettings {
  margin-top:16px; padding:10px 14px; border-radius:12px; border:none;
  background: linear-gradient(145deg, #0b84ff, #3299ff); color:#fff; font-size:16px; cursor:pointer;
}

@keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
</style>
</head>
<body>

<div class="card">
  <button id="bigBtn">0</button>
  <svg id="prog"><circle cx="75" cy="75" r="52" fill="none" stroke="#0b84ff" stroke-width="8" /></svg>

  <input id="maxInput" type="number" value="10" placeholder="Max Number">
  <select id="modeSelect">
    <option value="squats">Squats</option>
    <option value="pushups">Push-ups</option>
    <option value="pullups">Pull-ups</option>
    <option value="burpees">Burpees</option>
    <option value="custom">Custom</option>
  </select>
  <input id="customSecondsPerRep" type="number" placeholder="Seconds per rep" style="display:none;">
  <input id="restPerRepSec" type="number" value="10" placeholder="Rest per rep (sec)">

  <button id="autoBtn">Auto</button>
  <button id="resetBtn">Reset</button>
  <div id="stepText">Step 0</div>

  <div id="soundIcon">üîä</div>
  <div id="settingsIcon">‚öôÔ∏è</div>
  <div id="helpIcon">?</div>

  <!-- Help Popup -->
  <div id="helpPopup">
    <h2>Help</h2>
    <p>Manual / Auto modes, adjust max number, choose exercise, toggle sound and set your user level in settings.</p>
    <button id="closeHelp">Close</button>
  </div>

  <!-- Settings Popup -->
  <div id="settingsPopup">
    <h2>Settings / User Level</h2>
    <p>Select your workout intensity:</p>
    <label><input type="radio" name="level" value="athlete"> Athlete</label><br>
    <label><input type="radio" name="level" value="intermediate"> Intermediate</label><br>
    <label><input type="radio" name="level" value="low"> Low Intensity</label><br>
    <label><input type="radio" name="level" value="beginner" checked> Beginner</label>
    <button id="closeSettings">Close</button>
  </div>

  <audio id="clickButtonAudio" src="click-button.mp3"></audio>
  <audio id="progressSoundAudio" src="progress-sound.mp3"></audio>
  <audio id="helpButtonAudio" src="help-button.mp3"></audio>
</div>

<script>
(function(){
  const maxInput = document.getElementById('maxInput');
  const bigBtn = document.getElementById('bigBtn');
  const stepText = document.getElementById('stepText');
  const prog = document.getElementById('prog').querySelector('circle');
  const resetBtn = document.getElementById('resetBtn');
  const autoBtn = document.getElementById('autoBtn');
  const clickButtonAudio = document.getElementById('clickButtonAudio');
  const progressSoundAudio = document.getElementById('progressSoundAudio');
  const helpButtonAudio = document.getElementById('helpButtonAudio');
  const helpIcon = document.getElementById('helpIcon');
  const helpPopup = document.getElementById('helpPopup');
  const closeHelp = document.getElementById('closeHelp');
  const modeSelect = document.getElementById('modeSelect');
  const customSecondsPerRep = document.getElementById('customSecondsPerRep');
  const restPerRepSec = document.getElementById('restPerRepSec');
  const soundIcon = document.getElementById('soundIcon');
  const settingsIcon = document.getElementById('settingsIcon');
  const settingsPopup = document.getElementById('settingsPopup');
  const closeSettings = document.getElementById('closeSettings');
  const levelRadios = document.querySelectorAll('input[name="level"]');

  let max = parseInt(maxInput.value)||10;
  let current = 0;
  let dir = 1;
  let autoRunning = false;
  let autoTimer = null;
  let soundOn = true;
  let userLevel = 'beginner';
  const CIRC = 2*Math.PI*52;
  prog.style.strokeDasharray = CIRC;
  prog.style.strokeDashoffset = CIRC;

  function colorFor(val,maxV){ 
    if(maxV<=1) return 'hsl(120,100%,45%)'; 
    const ratio = Math.max(0,Math.min(1,val/maxV)); 
    const hue = 120-(120*ratio); 
    return `hsl(${hue},100%,50%)`; 
  }

  function playAudio(audio){ if(soundOn) audio.play().catch(()=>{}); }

  function updateUI(display=current){
    bigBtn.textContent=display;
    stepText.textContent=`Step ${current} of ${max*2-1}`;
    const offset = CIRC*(1-(current/max));
    prog.style.strokeDashoffset=offset;
    prog.style.stroke=colorFor(current,max);
  }

  function advanceStep(){
    playAudio(clickButtonAudio);
    current+=dir;
    if(current>=max) dir=-1;
    if(current<=1 && dir==-1) dir=1;
    updateUI();
  }

  bigBtn.addEventListener('click',()=>{ if(!autoRunning) advanceStep(); });
  resetBtn.addEventListener('click',()=>{
    clearTimeout(autoTimer);
    autoRunning=false;
    autoBtn.textContent="Auto";
    current=0; dir=1;
    updateUI();
  });

  function getExerciseSeconds(number){
    let mode = modeSelect.value; let baseSec=2;
    if(mode==='squats') baseSec=3;
    if(mode==='pushups') baseSec=2;
    if(mode==='pullups') baseSec=2.5;
    if(mode==='burpees') baseSec=3;
    if(mode==='custom') baseSec=parseFloat(customSecondsPerRep.value)||2;
    switch(userLevel){
      case 'athlete': baseSec*=0.7; break;
      case 'intermediate': baseSec*=1; break;
      case 'low': baseSec*=1.2; break;
      case 'beginner': baseSec*=1.5; break;
    }
    return baseSec*number;
  }

  function getRestSeconds(number){
    let rest=parseFloat(restPerRepSec.value)||10;
    switch(userLevel){
      case 'athlete': rest*=0.7; break;
      case 'intermediate': rest*=1; break;
      case 'low': rest*=1.2; break;
      case 'beginner': rest*=1.5; break;
    }
    return rest*number;
  }

  function autoStep(){
    let totalTime=getExerciseSeconds(current)+getRestSeconds(current);
    let interval=100; let steps=totalTime*1000/interval; let elapsed=0;
    playAudio(progressSoundAudio);
    function tick(){
      elapsed++;
      let remaining=Math.ceil((steps-elapsed)*interval/1000);
      bigBtn.textContent=remaining;
      const percent=elapsed/steps;
      const offset=CIRC*(1-percent);
      prog.style.strokeDashoffset=offset;
      prog.style.stroke=colorFor(current,max);
      if(elapsed<steps&&autoRunning){ autoTimer=setTimeout(tick,interval); }
      else {
        current+=dir;
        if(current>=max) dir=-1;
        if(current<=1&&dir==-1) dir=1;
        if(autoRunning) autoStep();
      }
    }
    tick();
  }

  autoBtn.addEventListener('click',()=>{
    if(autoRunning){ clearTimeout(autoTimer); autoRunning=false; autoBtn.textContent="Auto"; updateUI(); return; }
    autoRunning=true; autoBtn.textContent="Stop"; autoStep();
  });

  helpIcon.addEventListener('click',()=>{ playAudio(helpButtonAudio); helpPopup.style.display='block'; });
  closeHelp.addEventListener('click',()=>{ helpPopup.style.display='none'; });
  window.addEventListener('click',(e)=>{ if(e.target===helpPopup) helpPopup.style.display='none'; });

  modeSelect.addEventListener('change',()=>{ customSecondsPerRep.style.display=(modeSelect.value==='custom')?'inline-block':'none'; });
  maxInput.addEventListener('change',()=>{ max=parseInt(maxInput.value)||10; updateUI(); });
  soundIcon.addEventListener('click',()=>{ soundOn=!soundOn; soundIcon.textContent=soundOn?'üîä':'üîá'; });

  settingsIcon.addEventListener('click',()=>{ settingsPopup.style.display='block'; });
  closeSettings.addEventListener('click',()=>{ settingsPopup.style.display='none'; });
  window.addEventListener('click',(e)=>{ if(e.target===settingsPopup) settingsPopup.style.display='none'; });
  levelRadios.forEach(radio=>{ radio.addEventListener('change',()=>{ if(radio.checked) userLevel=radio.value; }); });

  updateUI();
})();
</script>

</body>
</html>